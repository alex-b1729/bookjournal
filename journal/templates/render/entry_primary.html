{% load entry_tags %}

{# for request user view only at this point #}

<div class="entry-header">
    <span class="entry-dt">{{ entry.publish_dt }}</span>
    - <span class="entry-author">{{ entry.author.username }}</span>
    - <span class="entry-visibility">{{ entry.get_visibility_display }}</span>
</div>

<div class="entry-body">
    <div class="entry-book">
        <a href="{% url 'user_book_entry_list' entry.book.pk %}" class="entry-book-title">
            {{ entry.book.title }}
        </a>
        {% if entry.book.published %} - {{ entry.book.published }}{% endif %}
        {% if entry.book.authors %}
        -
        {% for author in entry.book.authors.all %}
        <a href="{{ author.get_absolute_url }}">
            {{ author }}
        </a>{% if not forloop.last %}, {% endif %}
        {% endfor %}
        {% endif %}
        {% with sec=entry.section chap=entry.chapter %}
        {% if sec or chap %}
        <br/>
        {% endif %}
        {% if sec %}{{ sec }}{% endif %}{% if sec and chap %}, {% endif %}
        {% if chap %}Chapter {{ chap }}{% endif %}
        {% endwith %}
    </div>

    {% with tags=entry.tags %}
    {% if tags %}
    <div class="tag-container">
        {% include 'render/tag_partial.html' with tags=tags %}
    </div>
    {% endif %}
    {% endwith %}

    <div class="entry-content">
        {% if entry.title %}
        <h1 class="entry-title">
            {{ entry.title }}
        </h1>
        {% endif %}

        <div class="entry-markdown">{{ entry.body|markdown|linebreaks }}</div>
    </div>
</div>