{% extends 'base.html' %}
{% load entry_tags %}

{% block content %}
<h2>
    Entries
    {% if tag %}
    tagged with "{{ tag.name }}"
    {% endif %}
</h2>
<ul>
    {% for entry in entries %}
    <li>
        <h5>
            {% if entry.status == 'd' %}
            <span>(Draft)</span>
            {% endif %}
            <a href="{{ entry.get_absolute_url }}">
                {% if entry.title %}
                {{ entry.title }} ({{ entry.book }})
                {% else %}
                {{ entry.book }}
                {% endif %}
            </a>
        </h5>
        <p>
            {% with sec=entry.section chap=entry.chapter %}
            {% if sec %}{{ sec }}{% endif %}{% if sec and chap %}, {% endif %}
            {% if chap %}Chapter {{ chap }}{% endif %}
            {% endwith %}
        </p>
        <p>{{ entry.publish_dt }} - {{ entry.author }}</p>
        {% if entry.tags.exists %}
        <p>
            Tags:
            {% for tag in entry.tags.all %}
            <a href="{% url 'entry_list' entry.author.username %}?tag={{ tag.slug }}">
                {{ tag }}
            </a>
            {% if not forloop.last %} | {% endif %}
            {% endfor %}
        </p>
        {% endif %}
        <p>{{ entry.body|markdown }}</p>
    </li>
    {% empty %}
    <li>You don't have any entries yet</li>
    {% endfor %}
</ul>

{% include 'partials/pagination.html' with page=page_obj tag=tag %}
{% endblock content %}
